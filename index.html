<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luke's Bracket Buster 2025</title>
    <style>
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); 
            color: #ecf0f1; 
            position: relative; 
        }
        body::before { 
            content: ""; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-image: url('https://github.com/spoofjack/Bracket-Buster/blob/main/IMG_20241015_182451.jpg?raw=true'); 
            background-size: cover; 
            background-position: center; 
            opacity: 0.3; 
            z-index: -1; 
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
        }
        h1 { 
            color: #3498db; 
            margin: 10px 0; 
            font-size: 2.5em; 
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3); 
        }
        .controls { 
            max-width: 600px; 
            margin: 0 auto 30px; 
            background: rgba(52, 73, 94, 0.9); 
            padding: 25px; 
            border-radius: 15px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.3); 
            border: 1px solid #2c3e50; 
        }
        .controls h3 { 
            text-align: center; 
            margin-bottom: 20px; 
            color: #ecf0f1; 
        }
        .weight-input { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            margin: 15px 0; 
            position: relative; 
        }
        .weight-input label { 
            width: 80px; 
            font-weight: bold; 
            color: #bdc3c7; 
            position: relative; 
            cursor: help; 
            text-align: right; 
            margin-right: 10px; 
        }
        .weight-input label::after { 
            content: attr(data-tooltip); 
            position: absolute; 
            left: 100%; 
            top: -50%; 
            transform: translateY(-100%); 
            background: #2c3e50; 
            color: #ecf0f1; 
            padding: 8px; 
            border-radius: 5px; 
            font-size: 0.9em; 
            white-space: nowrap; 
            opacity: 0; 
            pointer-events: none; 
            transition: opacity 0.2s; 
            z-index: 10; 
        }
        .weight-input label:hover::after, 
        .weight-input label:focus::after { 
            opacity: 1; 
        }
        @media (max-width: 600px) {
            .weight-input label::after { 
                top: 100%; 
                left: 0; 
                transform: none; 
                width: 200px; 
                white-space: normal; 
            }
        }
        .weight-input input { 
            width: 100px; 
            padding: 10px; 
            border: 1px solid #7f8c8d; 
            border-radius: 5px; 
            background: #ecf0f1; 
            color: #2c3e50; 
            transition: border-color 0.3s; 
        }
        .weight-input input:focus { 
            border-color: #3498db; 
            outline: none; 
        }
        button { 
            display: block; 
            width: 200px; 
            margin: 20px auto 0; 
            padding: 12px; 
            background: #2980b9; 
            color: #ecf0f1; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 1.1em; 
            transition: background 0.3s, transform 0.2s; 
        }
        button:hover:not(:disabled) { 
            background: #3498db; 
            transform: translateY(-2px); 
        }
        button:disabled { 
            background: #7f8c8d; 
            cursor: not-allowed; 
        }
        #bracket-results { 
            max-width: 1200px; 
            margin: 0 auto; 
        }
        .region { 
            background: rgba(52, 73, 94, 0.9); 
            padding: 20px; 
            border-radius: 15px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.3); 
            margin-bottom: 20px; 
            border: 1px solid #2c3e50; 
        }
        .region h3 { 
            text-align: center; 
            color: #3498db; 
            margin-bottom: 15px; 
            font-size: 1.5em; 
        }
        .round { 
            margin-bottom: 20px; 
            border-bottom: 1px solid #7f8c8d; 
            padding-bottom: 15px; 
        }
        .round:last-child { 
            border-bottom: none; 
        }
        .round h4 { 
            margin: 0 0 10px; 
            color: #bdc3c7; 
            text-transform: uppercase; 
            font-size: 1.2em; 
        }
        .matchup { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            padding: 10px; 
            margin: 5px 0; 
            background: #ecf0f1; 
            border: 1px solid #bdc3c7; 
            border-radius: 5px; 
            transition: background 0.2s; 
        }
        .matchup:hover { 
            background: #dfe6e9; 
        }
        .team { 
            flex: 1; 
            font-size: 1em; 
            text-align: center; 
            color: #2c3e50; 
        }
        .winner { 
            flex: 1; 
            color: #e74c3c; 
            font-weight: bold; 
            text-align: center; 
        }
        .final-four, .championship { 
            text-align: center; 
            margin-top: 40px; 
            background: rgba(52, 73, 94, 0.9); 
            padding: 20px; 
            border-radius: 15px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.3); 
        }
        .final-four h3, .championship h3 { 
            color: #3498db; 
            margin-bottom: 15px; 
            font-size: 1.5em; 
        }
        .champion { 
            font-weight: bold; 
            color: #e74c3c; 
            margin-top: 15px; 
            font-size: 1.5em; 
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3); 
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Luke's Bracket Buster 2025</h1>
    </div>
    <div class="controls">
        <h3>Custom Weights</h3>
        <div class="weight-input">
            <label data-tooltip="Adjusted Offensive Efficiency: Points scored per 100 possessions, adjusted for opponent strength">AdjO:</label>
            <input type="number" id="adjO" value="0.30" step="0.01" min="0">
        </div>
        <div class="weight-input">
            <label data-tooltip="Adjusted Defensive Efficiency: Points allowed per 100 possessions, adjusted for opponent strength">AdjD:</label>
            <input type="number" id="adjD" value="0.30" step="0.01" min="0">
        </div>
        <div class="weight-input">
            <label data-tooltip="Adjusted Tempo: Possessions per game, adjusted for opponent pace">AdjT:</label>
            <input type="number" id="adjT" value="0.20" step="0.01" min="0">
        </div>
        <div class="weight-input">
            <label data-tooltip="Luck Factor: Difference between actual and expected win percentage">Luck:</label>
            <input type="number" id="luck" value="0.10" step="0.01" min="0">
        </div>
        <div class="weight-input">
            <label data-tooltip="Upset Probability Multiplier: Increases chance of lower seeds winning">Upset:</label>
            <input type="number" id="upset" value="0.10" step="0.01" min="0">
        </div>
        <button onclick="predictTournament()">Predict Bracket</button>
    </div>
    <div id="bracket-results"></div>

    <script>
        console.log("Script loaded");

        const teamsData = [
            { Seed: 1, Region: "East", Team: "Duke", AdjO: 128.0, AdjD: 89.8, AdjT: 65.7, Luck: -0.019, Momentum: 0.9 },
            { Seed: 2, Region: "East", Team: "Alabama", AdjO: 126.5, AdjD: 96.6, AdjT: 74.9, Luck: 0.029, Momentum: 0.76 },
            { Seed: 3, Region: "East", Team: "Wisconsin", AdjO: 122.0, AdjD: 96.0, AdjT: 67.6, Luck: -0.033, Momentum: 0.74 },
            { Seed: 4, Region: "East", Team: "Arizona", AdjO: 122.5, AdjD: 96.8, AdjT: 69.9, Luck: -0.049, Momentum: 0.65 },
            { Seed: 5, Region: "East", Team: "Oregon", AdjO: 116.6, AdjD: 96.5, AdjT: 67.6, Luck: 0.085, Momentum: 0.73 },
            { Seed: 6, Region: "East", Team: "BYU", AdjO: 123.0, AdjD: 100.6, AdjT: 67.2, Luck: 0.036, Momentum: 0.73 },
            { Seed: 7, Region: "East", Team: "Saint Mary's", AdjO: 115.3, AdjD: 92.2, AdjT: 61.7, Luck: 0.005, Momentum: 0.85 },
            { Seed: 8, Region: "East", Team: "Mississippi St.", AdjO: 118.7, AdjD: 98.6, AdjT: 68.1, Luck: 0.012, Momentum: 0.64 },
            { Seed: 9, Region: "East", Team: "Baylor", AdjO: 120.8, AdjD: 99.7, AdjT: 64.5, Luck: -0.054, Momentum: 0.58 },
            { Seed: 10, Region: "East", Team: "Vanderbilt", AdjO: 117.9, AdjD: 101.8, AdjT: 69.4, Luck: 0.025, Momentum: 0.63 },
            { Seed: 11, Region: "East", Team: "VCU", AdjO: 116.3, AdjD: 95.7, AdjT: 66.1, Luck: -0.051, Momentum: 0.82 },
            { Seed: 12, Region: "East", Team: "Liberty", AdjO: 112.5, AdjD: 98.9, AdjT: 65.3, Luck: 0.000, Momentum: 0.82 },
            { Seed: 13, Region: "East", Team: "Akron", AdjO: 113.7, AdjD: 107.1, AdjT: 71.4, Luck: 0.071, Momentum: 0.82 },
            { Seed: 14, Region: "East", Team: "Montana", AdjO: 110.8, AdjD: 110.4, AdjT: 67.0, Luck: 0.186, Momentum: 0.74 },
            { Seed: 15, Region: "East", Team: "Robert Morris", AdjO: 107.0, AdjD: 104.9, AdjT: 67.8, Luck: 0.088, Momentum: 0.76 },
            { Seed: 16, Region: "East", Team: "American", AdjO: 102.1, AdjD: 108.0, AdjT: 63.5, Luck: 0.133, Momentum: 0.65 },
            { Seed: 16, Region: "East", Team: "Mount St. Mary's", AdjO: 100.1, AdjD: 106.8, AdjT: 67.4, Luck: 0.147, Momentum: 0.65 },
            { Seed: 1, Region: "Midwest", Team: "Houston", AdjO: 123.2, AdjD: 87.8, AdjT: 61.4, Luck: 0.015, Momentum: 0.88 },
            { Seed: 2, Region: "Midwest", Team: "Tennessee", AdjO: 120.3, AdjD: 89.1, AdjT: 63.6, Luck: 0.016, Momentum: 0.79 },
            { Seed: 3, Region: "Midwest", Team: "Kentucky", AdjO: 123.8, AdjD: 99.5, AdjT: 70.9, Luck: 0.007, Momentum: 0.67 },
            { Seed: 4, Region: "Midwest", Team: "Purdue", AdjO: 124.2, AdjD: 100.4, AdjT: 65.0, Luck: -0.007, Momentum: 0.67 },
            { Seed: 5, Region: "Midwest", Team: "Clemson", AdjO: 118.7, AdjD: 94.7, AdjT: 64.2, Luck: -0.032, Momentum: 0.82 },
            { Seed: 6, Region: "Midwest", Team: "Illinois", AdjO: 121.6, AdjD: 98.1, AdjT: 71.3, Luck: -0.018, Momentum: 0.64 },
            { Seed: 7, Region: "Midwest", Team: "UCLA", AdjO: 116.8, AdjD: 95.1, AdjT: 64.9, Luck: -0.008, Momentum: 0.69 },
            { Seed: 8, Region: "Midwest", Team: "Gonzaga", AdjO: 123.6, AdjD: 96.3, AdjT: 70.2, Luck: -0.074, Momentum: 0.76 },
            { Seed: 9, Region: "Midwest", Team: "Georgia", AdjO: 115.4, AdjD: 96.0, AdjT: 66.4, Luck: -0.001, Momentum: 0.63 },
            { Seed: 10, Region: "Midwest", Team: "Utah St.", AdjO: 120.7, AdjD: 105.5, AdjT: 67.5, Luck: 0.086, Momentum: 0.79 },
            { Seed: 11, Region: "Midwest", Team: "Texas", AdjO: 116.7, AdjD: 99.5, AdjT: 67.4, Luck: -0.057, Momentum: 0.56 },
            { Seed: 11, Region: "Midwest", Team: "Xavier", AdjO: 115.5, AdjD: 98.3, AdjT: 69.1, Luck: -0.020, Momentum: 0.66 },
            { Seed: 12, Region: "Midwest", Team: "McNeese", AdjO: 114.3, AdjD: 100.6, AdjT: 65.3, Luck: -0.023, Momentum: 0.82 },
            { Seed: 13, Region: "Midwest", Team: "High Point", AdjO: 118.5, AdjD: 109.1, AdjT: 66.4, Luck: 0.011, Momentum: 0.85 },
            { Seed: 14, Region: "Midwest", Team: "Troy", AdjO: 107.7, AdjD: 100.8, AdjT: 66.3, Luck: -0.009, Momentum: 0.70 },
            { Seed: 15, Region: "Midwest", Team: "Wofford", AdjO: 113.6, AdjD: 109.5, AdjT: 64.0, Luck: -0.032, Momentum: 0.56 },
            { Seed: 16, Region: "Midwest", Team: "SIUE", AdjO: 101.9, AdjD: 106.2, AdjT: 65.8, Luck: 0.052, Momentum: 0.67 },
            { Seed: 1, Region: "South", Team: "Auburn", AdjO: 128.4, AdjD: 93.4, AdjT: 67.6, Luck: 0.030, Momentum: 0.85 },
            { Seed: 2, Region: "South", Team: "Michigan St.", AdjO: 118.1, AdjD: 90.6, AdjT: 67.7, Luck: -0.009, Momentum: 0.82 },
            { Seed: 3, Region: "South", Team: "Iowa St.", AdjO: 119.4, AdjD: 92.4, AdjT: 68.6, Luck: -0.048, Momentum: 0.73 },
            { Seed: 4, Region: "South", Team: "Texas A&M", AdjO: 116.2, AdjD: 92.1, AdjT: 66.1, Luck: 0.001, Momentum: 0.69 },
            { Seed: 5, Region: "South", Team: "Michigan", AdjO: 116.0, AdjD: 93.7, AdjT: 69.4, Luck: 0.070, Momentum: 0.74 },
            { Seed: 6, Region: "South", Team: "Ole Miss", AdjO: 117.8, AdjD: 95.8, AdjT: 68.0, Luck: 0.018, Momentum: 0.67 },
            { Seed: 7, Region: "South", Team: "Marquette", AdjO: 117.7, AdjD: 96.1, AdjT: 67.6, Luck: -0.013, Momentum: 0.70 },
            { Seed: 8, Region: "South", Team: "Louisville", AdjO: 118.1, AdjD: 95.5, AdjT: 68.7, Luck: 0.058, Momentum: 0.79 },
            { Seed: 9, Region: "South", Team: "Creighton", AdjO: 116.9, AdjD: 98.2, AdjT: 67.0, Luck: 0.049, Momentum: 0.73 },
            { Seed: 10, Region: "South", Team: "New Mexico", AdjO: 112.5, AdjD: 95.2, AdjT: 72.7, Luck: 0.000, Momentum: 0.79 },
            { Seed: 11, Region: "South", Team: "San Diego St.", AdjO: 109.8, AdjD: 93.5, AdjT: 66.0, Luck: 0.010, Momentum: 0.70 },
            { Seed: 11, Region: "South", Team: "North Carolina", AdjO: 118.9, AdjD: 99.3, AdjT: 70.4, Luck: -0.019, Momentum: 0.63 },
            { Seed: 12, Region: "South", Team: "UC San Diego", AdjO: 115.2, AdjD: 96.5, AdjT: 65.7, Luck: 0.010, Momentum: 0.88 },
            { Seed: 13, Region: "South", Team: "Yale", AdjO: 115.1, AdjD: 104.0, AdjT: 67.2, Luck: -0.041, Momentum: 0.76 },
            { Seed: 14, Region: "South", Team: "Lipscomb", AdjO: 112.7, AdjD: 103.2, AdjT: 65.9, Luck: -0.028, Momentum: 0.74 },
            { Seed: 15, Region: "South", Team: "Bryant", AdjO: 106.7, AdjD: 105.5, AdjT: 72.5, Luck: -0.004, Momentum: 0.68 },
            { Seed: 16, Region: "South", Team: "Alabama St.", AdjO: 101.4, AdjD: 110.6, AdjT: 67.7, Luck: 0.049, Momentum: 0.56 },
            { Seed: 16, Region: "South", Team: "Saint Francis U", AdjO: 99.7, AdjD: 112.4, AdjT: 66.9, Luck: 0.074, Momentum: 0.48 },
            { Seed: 1, Region: "West", Team: "Florida", AdjO: 128.6, AdjD: 92.4, AdjT: 69.6, Luck: 0.007, Momentum: 0.88 },
            { Seed: 2, Region: "West", Team: "St. John's", AdjO: 113.9, AdjD: 87.5, AdjT: 70.1, Luck: -0.019, Momentum: 0.88 },
            { Seed: 3, Region: "West", Team: "Texas Tech", AdjO: 125.3, AdjD: 97.2, AdjT: 65.4, Luck: -0.045, Momentum: 0.76 },
            { Seed: 4, Region: "West", Team: "Maryland", AdjO: 118.1, AdjD: 91.8, AdjT: 69.8, Luck: -0.038, Momentum: 0.76 },
            { Seed: 5, Region: "West", Team: "Memphis", AdjO: 113.1, AdjD: 97.8, AdjT: 70.8, Luck: 0.090, Momentum: 0.85 },
            { Seed: 6, Region: "West", Team: "Missouri", AdjO: 125.3, AdjD: 100.9, AdjT: 68.2, Luck: -0.048, Momentum: 0.67 },
            { Seed: 7, Region: "West", Team: "Kansas", AdjO: 116.0, AdjD: 92.7, AdjT: 68.4, Luck: -0.024, Momentum: 0.64 },
            { Seed: 8, Region: "West", Team: "UConn", AdjO: 121.9, AdjD: 102.6, AdjT: 63.7, Luck: -0.019, Momentum: 0.70 },
            { Seed: 9, Region: "West", Team: "Oklahoma", AdjO: 119.0, AdjD: 100.7, AdjT: 68.5, Luck: 0.005, Momentum: 0.61 },
            { Seed: 10, Region: "West", Team: "Arkansas", AdjO: 112.9, AdjD: 95.2, AdjT: 69.3, Luck: -0.008, Momentum: 0.61 },
            { Seed: 11, Region: "West", Team: "Drake", AdjO: 112.6, AdjD: 98.5, AdjT: 58.8, Luck: 0.004, Momentum: 0.91 },
            { Seed: 12, Region: "West", Team: "Colorado St.", AdjO: 116.2, AdjD: 98.9, AdjT: 66.0, Luck: 0.025, Momentum: 0.74 },
            { Seed: 13, Region: "West", Team: "Grand Canyon", AdjO: 107.8, AdjD: 100.6, AdjT: 71.4, Luck: 0.019, Momentum: 0.79 },
            { Seed: 14, Region: "West", Team: "UNC Wilmington", AdjO: 112.3, AdjD: 107.1, AdjT: 65.3, Luck: 0.055, Momentum: 0.79 },
            { Seed: 15, Region: "West", Team: "Omaha", AdjO: 111.0, AdjD: 110.5, AdjT: 67.7, Luck: 0.071, Momentum: 0.65 },
            { Seed: 16, Region: "West", Team: "Norfolk St.", AdjO: 107.1, AdjD: 108.7, AdjT: 66.3, Luck: 0.056, Momentum: 0.71 }
        ];

        const upsetProbabilities = {
            "1vs16": 0.01, "2vs15": 0.06, "3vs14": 0.15, "4vs13": 0.20,
            "5vs12": 0.35, "6vs11": 0.33, "7vs10": 0.40, "8vs9": 0.50,
            "1vs8": 0.15, "2vs7": 0.20, "3vs6": 0.25, "4vs5": 0.30
        };

        function calculateTeamScore(team, weights) {
            return (weights.AdjO * team.AdjO) +
                   (weights.AdjD * (200 - team.AdjD)) +
                   (weights.AdjT * team.AdjT) +
                   (weights.Luck * team.Luck * 100) +
                   (team.Momentum * 10);
        }

        function getUpsetProbability(seed1, seed2) {
            const matchup = `${Math.min(seed1, seed2)}vs${Math.max(seed1, seed2)}`;
            return upsetProbabilities[matchup] || 0.25;
        }

        function simulateMatchup(team1, team2, weights, round) {
            let team1Wins = 0;
            let team2Wins = 0;
            const simulations = 3;

            for (let i = 0; i < simulations; i++) {
                let score1 = calculateTeamScore(team1, weights);
                let score2 = calculateTeamScore(team2, weights);
                const random1 = 0.85 + Math.random() * 0.3;
                const random2 = 0.85 + Math.random() * 0.3;
                score1 *= random1;
                score2 *= random2;
                const seedDiff = Math.abs(team1.Seed - team2.Seed);
                const upsetChance = getUpsetProbability(team1.Seed, team2.Seed) * weights.Upset;
                const isUpsetPossible = Math.random() < upsetChance && seedDiff >= 3;
                if (isUpsetPossible && team1.Seed > team2.Seed) score1 *= 1.1;
                else if (isUpsetPossible && team2.Seed > team1.Seed) score2 *= 1.1;
                if (round === "Elite 8" || round === "Final Four" || round === "Championship") {
                    if (team1.Seed < team2.Seed) score1 *= 1.05;
                    else if (team2.Seed < team1.Seed) score2 *= 1.05;
                }
                if (score1 > score2) team1Wins++;
                else team2Wins++;
            }

            return team1Wins > team2Wins ? team1 : team2;
        }

        function simulateRound(teams, weights, roundName) {
            const winners = [];
            for (let i = 0; i < teams.length - 1; i += 2) {
                const winner = simulateMatchup(teams[i], teams[i + 1], weights, roundName);
                winners.push(winner);
            }
            return winners;
        }

        function predictTournament() {
            console.log("Predict button clicked");
            const button = document.querySelector("button");
            button.innerText = "Generating Bracket";
            button.disabled = true;

            const weights = {
                AdjO: parseFloat(document.getElementById("adjO").value) || 0,
                AdjD: parseFloat(document.getElementById("adjD").value) || 0,
                AdjT: parseFloat(document.getElementById("adjT").value) || 0,
                Luck: parseFloat(document.getElementById("luck").value) || 0,
                Upset: parseFloat(document.getElementById("upset").value) || 0
            };
            console.log("Weights:", weights);

            const regions = {
                "East": teamsData.filter(t => t.Region === "East").sort((a, b) => a.Seed - b.Seed),
                "Midwest": teamsData.filter(t => t.Region === "Midwest").sort((a, b) => a.Seed - b.Seed),
                "South": teamsData.filter(t => t.Region === "South").sort((a, b) => a.Seed - b.Seed),
                "West": teamsData.filter(t => t.Region === "West").sort((a, b) => a.Seed - b.Seed)
            };

            const firstFourWinners = {
                "East": [
                    simulateMatchup(regions["East"].find(t => t.Seed === 16 && t.Team === "American"), 
                                   regions["East"].find(t => t.Seed === 16 && t.Team === "Mount St. Mary's"), 
                                   weights, "First Four")
                ],
                "Midwest": [
                    simulateMatchup(regions["Midwest"].find(t => t.Seed === 11 && t.Team === "Texas"), 
                                   regions["Midwest"].find(t => t.Seed === 11 && t.Team === "Xavier"), 
                                   weights, "First Four")
                ],
                "South": [
                    simulateMatchup(regions["South"].find(t => t.Seed === 11 && t.Team === "San Diego St."), 
                                   regions["South"].find(t => t.Seed === 11 && t.Team === "North Carolina"), 
                                   weights, "First Four"),
                    simulateMatchup(regions["South"].find(t => t.Seed === 16 && t.Team === "Alabama St."), 
                                   regions["South"].find(t => t.Seed === 16 && t.Team === "Saint Francis U"), 
                                   weights, "First Four")
                ],
                "West": []
            };

            const bracket = {};
            for (const region in regions) {
                const teams = regions[region];
                const round64Teams = [
                    teams.find(t => t.Seed === 1),
                    region === "East" || region === "South" ? firstFourWinners[region][region === "South" ? 1 : 0] : teams.find(t => t.Seed === 16),
                    teams.find(t => t.Seed === 8),
                    teams.find(t => t.Seed === 9),
                    teams.find(t => t.Seed === 5),
                    teams.find(t => t.Seed === 12),
                    teams.find(t => t.Seed === 4),
                    teams.find(t => t.Seed === 13),
                    teams.find(t => t.Seed === 6),
                    region === "Midwest" || region === "South" ? firstFourWinners[region][0] : teams.find(t => t.Seed === 11),
                    teams.find(t => t.Seed === 3),
                    teams.find(t => t.Seed === 14),
                    teams.find(t => t.Seed === 7),
                    teams.find(t => t.Seed === 10),
                    teams.find(t => t.Seed === 2),
                    teams.find(t => t.Seed === 15)
                ];

                bracket[region] = {
                    "Round of 64": round64Teams,
                    "Round of 32": simulateRound(round64Teams, weights, "Round of 32"),
                    "Sweet 16": null,
                    "Elite 8": null
                };
                bracket[region]["Sweet 16"] = simulateRound(bracket[region]["Round of 32"], weights, "Sweet 16");
                bracket[region]["Elite 8"] = simulateRound(bracket[region]["Sweet 16"], weights, "Elite 8");
            }

            const finalFourTeams = [
                bracket["East"]["Elite 8"][0],
                bracket["West"]["Elite 8"][0],
                bracket["South"]["Elite 8"][0],
                bracket["Midwest"]["Elite 8"][0]
            ];
            const finalFour = simulateRound(finalFourTeams, weights, "Final Four");
            const championship = simulateRound(finalFour, weights, "Championship");

            let html = "";
            for (const region in bracket) {
                html += '<div class="region"><h3>' + region + ' Region</h3>';
                if (firstFourWinners[region].length > 0) {
                    html += '<div class="round"><h4>First Four</h4>';
                    firstFourWinners[region].forEach((winner, index) => {
                        let teams;
                        if (region === "East") {
                            teams = [
                                regions[region].find(t => t.Seed === 16 && t.Team === "American"),
                                regions[region].find(t => t.Seed === 16 && t.Team === "Mount St. Mary's")
                            ];
                        } else if (region === "Midwest") {
                            teams = [
                                regions[region].find(t => t.Seed === 11 && t.Team === "Texas"),
                                regions[region].find(t => t.Seed === 11 && t.Team === "Xavier")
                            ];
                        } else if (region === "South" && index === 0) {
                            teams = [
                                regions[region].find(t => t.Seed === 11 && t.Team === "San Diego St."),
                                regions[region].find(t => t.Seed === 11 && t.Team === "North Carolina")
                            ];
                        } else if (region === "South" && index === 1) {
                            teams = [
                                regions[region].find(t => t.Seed === 16 && t.Team === "Alabama St."),
                                regions[region].find(t => t.Seed === 16 && t.Team === "Saint Francis U")
                            ];
                        }
                        html += '<div class="matchup">' +
                                    '<div class="team">(' + teams[0].Seed + ') ' + teams[0].Team + '</div>' +
                                    '<div class="team">(' + teams[1].Seed + ') ' + teams[1].Team + '</div>' +
                                    '<div class="winner">Winner: ' + winner.Team + '</div>' +
                                '</div>';
                    });
                    html += '</div>';
                }

                const rounds = ["Round of 64", "Round of 32", "Sweet 16", "Elite 8"];
                rounds.forEach(round => {
                    html += '<div class="round"><h4>' + round + '</h4>';
                    const nextRound = round === "Round of 64" ? "Round of 32" : 
                                     round === "Round of 32" ? "Sweet 16" : 
                                     round === "Sweet 16" ? "Elite 8" : "Final Four";
                    for (let i = 0; i < bracket[region][round].length - 1; i += 2) {
                        const team1 = bracket[region][round][i];
                        const team2 = bracket[region][round][i + 1];
                        const winner = nextRound === "Final Four" ? 
                            (finalFour.includes(team1) ? team1 : team2) :
                            bracket[region][nextRound].includes(team1) ? team1 : team2;
                        html += '<div class="matchup">' +
                                    '<div class="team">(' + team1.Seed + ') ' + team1.Team + '</div>' +
                                    '<div class="team">(' + team2.Seed + ') ' + team2.Team + '</div>' +
                                    '<div class="winner">Winner: ' + winner.Team + '</div>' +
                                '</div>';
                    }
                    html += '</div>';
                });
                html += '</div>';
            }

            // Fixed Final Four and Championship display
            html += '<div class="final-four"><h3>Final Four</h3>';
            html += '<div class="matchup">' +
                        '<div class="team">(' + finalFourTeams[0].Seed + ') ' + finalFourTeams[0].Team + '</div>' +
                        '<div class="team">(' + finalFourTeams[1].Seed + ') ' + finalFourTeams[1].Team + '</div>' +
                        '<div class="winner">Winner: ' + finalFour[0].Team + '</div>' +
                    '</div>';
            html += '<div class="matchup">' +
                        '<div class="team">(' + finalFourTeams[2].Seed + ') ' + finalFourTeams[2].Team + '</div>' +
                        '<div class="team">(' + finalFourTeams[3].Seed + ') ' + finalFourTeams[3].Team + '</div>' +
                        '<div class="winner">Winner: ' + finalFour[1].Team + '</div>' +
                    '</div>';
            html += '</div>';

            html += '<div class="championship"><h3>Championship</h3>';
            html += '<div class="matchup">' +
                        '<div class="team">(' + finalFour[0].Seed + ') ' + finalFour[0].Team + '</div>' +
                        '<div class="team">(' + finalFour[1].Seed + ') ' + finalFour[1].Team + '</div>' +
                        '<div class="winner">Winner: ' + championship[0].Team + '</div>' +
                    '</div>';
            html += '<div class="champion">Champion: ' + championship[0].Team + '</div></div>';

            console.log("Rendering bracket");
            document.getElementById("bracket-results").innerHTML = html;

            button.innerText = "Done!";
            setTimeout(() => {
                button.innerText = "Predict Bracket";
                button.disabled = false;
            }, 1000);
        }
    </script>
</body>
</html>
